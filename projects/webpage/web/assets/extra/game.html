<!DOCTYPE html>
<html>
    <head>
        <link rel='stylesheet' href='style.css'>
        <script>
            // PLAY THE GAME HERE: https://bluegrasscoms.com/halloween/
// Created by Mike Samways and Rachel Russell for @Bluegrasscoms

function randomExcluded(min, max, excluded) {
  var n = Math.floor(Math.random() * (max-min) + min);
  if (n >= excluded) n++;
  return n;
}


var score = 0,
    previousTarget = 0;


function gameEnd() {

  var endgifs = ["https://www.dropbox.com/s/x56jqmgqdh4weh9/congrats.gif?raw=1", "https://www.dropbox.com/s/zpcj50qk7unal91/congrats2.gif?raw=1", "https://www.dropbox.com/s/agsedov8mlnxh9j/congrats3.gif?raw=1", "https://www.dropbox.com/s/ck1ptya4uxthtl8/congrats4.gif?raw=1"];
  $('#game').removeClass('in-game').html('<div style="text-align: center"><img class="congratsimg" src="'+endgifs[Math.floor((Math.random() * 4))]+'"/><p class="scored">YOU SCORED <strong style="font-size: 53px;display: block;">'+score+'</strong></p><button id="playgame">Play Again</button><div class="social-share">Share your score: <ul><li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A//bluegrasscoms.com/halloween" target="_blank"><img src="https://www.dropbox.com/s/vsfuchbzym4cl7i/facebook.svg?raw=1"/></a></li><li><a href="https://twitter.com/home?status=I%20scored%20'+score+'%20on%20the%20Wanted%20-%20Dead%20or%20Alive%20Halloween%20Game,%20try%20and%20beat%20my%20score%20here%20https%3A//bit.ly/2ECobCh%20%23WantedDeadOrAlive%20%23Halloween%20%23Bluegrasscoms" target="_blank"><img src="https://www.dropbox.com/s/ulp7ittyz8wbgy5/twitter.svg?raw=1"/></a></li></ul></div></div>');
  $('#playgame').on('click', function() {
    score = 0;
    startgame();
  });
}

function roundFunction() {

  var icons = ["icon0", "icon1", "icon2", "icon3", "icon4", "icon5"];

  var target = randomExcluded(0,5,previousTarget),
      hasTarget = false,
      iconhtml = '';

  previousTarget = target;

  $('#game-target').addClass('icon'+target);

  var count = 30;

  for (i = 0; i < count; i++) {

    if(i === 29) {
   
      setTimeout(function() {

        var theTarget = $('#game-main').find('.icon'+target);

        if(theTarget.length > 0) {

          var number = randomExcluded(0,5,target);
          $('#game-main').append('<div class="icon '+icons[number]+'"></div>');

        } else {

          $('#game-main').append('<div class="icon icon'+target+'"></div>');

        }

      }, 1);


    } else {

      var number = Math.floor(Math.random() * 6);
      
      if(number == target && hasTarget == false) {

        iconhtml += '<div class="icon '+icons[number]+'"></div>';
        hasTarget = true;
        
      } else {

        var number = randomExcluded(0,5,target);
        iconhtml += '<div class="icon '+icons[number]+'"></div>';

      }

    }

  }

  $('#game-main').html(iconhtml);

}

function round() {

  $('#game-main').html('');

  roundFunction();

  $('#game-main').on('click', '.icon', function() {

    var targetClass = $('#game-target').attr('class');

    if($(this).hasClass(targetClass)) {

      $(this).addClass('correct');

      score += 5;
      $('#score').html(score);

      $('#game-main').addClass('clicked');

      setTimeout(function() {
        $('#game-main').removeClass('clicked');
        $('#game-target').attr('class', '');
        roundFunction();
      }, 700);

    } else {

      var that = $(this);
      that.addClass('wrong');

      if(score > 0) {
        score -= 1;
        $('#score').html(score);
      }
 
      setTimeout(function() {
        that.removeClass('wrong');
      }, 700)

    }

  });

}

function startgame() {

  $('#game').addClass('in-game').html('<h2 class="gameheading">Happy Halloween</h2><div id="game-target"></div><div id="game-main"></div><div id="score">0</div><div id="counter">30</div>');

  round();

  countdown();


  setTimeout(function() {

    var timer = setInterval(function() {
    var firsticon = $('#game-main .icon:first-child');

      firsticon.clone().appendTo('#game-main');
      firsticon.remove();

    }, 1000);
    
    var number = 30,
        gameCounter = $('#counter');

    var counter = setInterval(function() {
      number = (number -= 1);
      gameCounter.html(number);
    }, 1000);

    setTimeout(function() {
      clearInterval(timer);
      clearInterval(counter);
      gameEnd();
    }, 30000)

  }, 3000);

}

function countdown() {

  $('<div class="countdown"><div class="number active">3</div></div>').appendTo('body');

  var countdownNumber = 3,
      numberContainer = $('.number');


  var counter = setInterval(function() {
    countdownNumber = (countdownNumber -= 1);
    numberContainer.html(countdownNumber).addClass('active');
  }, 1000);

  setTimeout(function() {
    clearInterval(counter);
     $('.countdown').remove();
  }, 3000);

}

$(document).ready(function() {

  if ($(window).width() > 800) {
    var video = '<video autoplay muted loop id="gameVideo"><source src="https://www.dropbox.com/s/pqdvbksztp2wyri/background.mp4?raw=1" type="video/mp4"></video>';
    $(video).prependTo('body');
    $('body').addClass('hasvideo');
  }

  $('#game').html('<div class="intro"><h2 class="gameheading"><span>Wanted</span> Dead or alive</h2><p>Find the wanted character quickly before they move to earn 5 points, click on the wrong ghoul and lose a point but work fast, you only have <strong>30 seconds</strong>! <span style="display: block;margin-top: 10px"><strong>Ghooooooood luuuck!</strong></span></p><button id="startgame">Start Game</button></div>');
  $('#game').on('click', '#startgame', function() {
    startgame();
  });

});
        </script>
    </head>
    <style>
        
    </style>
    <body>
        .tic-tac-toe
        - for (var turn = 1; turn <= 9; turn++)
          - for (var row = 1; row <= 3; row++)
            - for (var column = 1; column <= 3; column++)
              - var player = "1"
              - var positionHorizontal = ""
              - var positionVertical = ""
              - var positionDiagonal = ""
              
              if( turn % 2 == 0 )
                - var player = "2"
                
              if( column == 1 )
                - var positionHorizontal = " left first-column"
              else if( column == 2 )
                - var positionHorizontal = " middle second-column"
              else if( column == 3 )
                - var positionHorizontal = " right third-column"
               
              if( row == 1 )
                - var positionVertical = " top first-row"
              else if( row == 2 )
                - var positionVertical = " center second-row"
              else if( row == 3 )
                - var positionVertical = " bottom third-row"
              
              if( row == 1 && column == 1 )
                - var positionDiagonal = " first-diagonal"
              else if( row == 1 && column == 3 )
                - var positionDiagonal = " second-diagonal"
              else if( row == 2 && column == 2 )
                - var positionDiagonal = " first-diagonal second-diagonal"
              else if( row == 3 && column == 1 )
                - var positionDiagonal = " second-diagonal"
              else if( row == 3 && column == 3 )
                - var positionDiagonal = " first-diagonal"
              
              input(id="block" + turn + "-" + row + "-" + column type="radio" class="player-" + player + positionHorizontal + positionVertical + positionDiagonal + " turn-" + turn)
              label(for="block" + turn + "-" + row + "-" + column class="turn-" + turn)
      
        .end
          h3
          a(href="") Restart
          
      h5 Note: use the Full Page view for the best experience.
    </body>
</html>